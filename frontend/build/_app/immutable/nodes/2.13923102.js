import{s as Q,n as A,o as Z}from"../chunks/scheduler.e108d1fd.js";import{S as $,i as ee,g as q,s as B,y as W,h as O,j as I,z as te,c as L,A as F,f as D,k as b,a as X,x as S,B as le,C as N,m as ne,n as se,l as k,o as oe}from"../chunks/index.cb7074c8.js";function T(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function R(o,e,t){const u=o.slice();return u[16]=e[t],u[18]=t,u}function z(o,e,t){const u=o.slice();return u[19]=e[t],u}function H(o,e,t){const u=o.slice();return u[22]=e[t],u}function V(o){let e,t,u,m,c;return{c(){e=W("line"),this.h()},l(f){e=F(f,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),I(e).forEach(D),this.h()},h(){b(e,"x1",t=o[22].x1),b(e,"y1",u=o[22].y1),b(e,"x2",m=o[22].x2),b(e,"y2",c=o[22].y2),b(e,"stroke","black"),b(e,"stroke-width","2")},m(f,s){X(f,e,s)},p(f,s){s&2&&t!==(t=f[22].x1)&&b(e,"x1",t),s&2&&u!==(u=f[22].y1)&&b(e,"y1",u),s&2&&m!==(m=f[22].x2)&&b(e,"x2",m),s&2&&c!==(c=f[22].y2)&&b(e,"y2",c)},d(f){f&&D(e)}}}function J(o){let e;return{c(){e=q("div"),this.h()},l(t){e=O(t,"DIV",{class:!0,style:!0}),I(e).forEach(D),this.h()},h(){b(e,"class","blue-dot"),k(e,"left",o[19].x+"px"),k(e,"top",o[19].y+"px")},m(t,u){X(t,e,u)},p(t,u){u&1&&k(e,"left",t[19].x+"px"),u&1&&k(e,"top",t[19].y+"px")},d(t){t&&D(e)}}}function U(o){let e,t,u=(o[16].number!==null?o[16].number:"")+"",m,c,f=T(o[16].blueDots),s=[];for(let r=0;r<f.length;r+=1)s[r]=J(z(o,f,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=B(),t=q("div"),m=ne(u),c=B(),this.h()},l(r){for(let l=0;l<s.length;l+=1)s[l].l(r);e=L(r),t=O(r,"DIV",{class:!0,style:!0});var d=I(t);m=se(d,u),c=L(d),d.forEach(D),this.h()},h(){b(t,"class","dot"),k(t,"left",o[16].x+"px"),k(t,"top",o[16].y+"px")},m(r,d){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(r,d);X(r,e,d),X(r,t,d),S(t,m),S(t,c)},p(r,d){if(d&1){f=T(r[16].blueDots);let l;for(l=0;l<f.length;l+=1){const x=z(r,f,l);s[l]?s[l].p(x,d):(s[l]=J(x),s[l].c(),s[l].m(e.parentNode,e))}for(;l<s.length;l+=1)s[l].d(1);s.length=f.length}d&1&&u!==(u=(r[16].number!==null?r[16].number:"")+"")&&oe(m,u),d&1&&k(t,"left",r[16].x+"px"),d&1&&k(t,"top",r[16].y+"px")},d(r){r&&(D(e),D(t)),N(s,r)}}}function ce(o){let e,t,u="Send Data",m,c,f,s,r,d=T(o[1]),l=[];for(let i=0;i<d.length;i+=1)l[i]=V(H(o,d,i));let x=T(o[0]),_=[];for(let i=0;i<x.length;i+=1)_[i]=U(R(o,x,i));return{c(){e=q("main"),t=q("button"),t.textContent=u,m=B(),c=W("svg");for(let i=0;i<l.length;i+=1)l[i].c();f=B();for(let i=0;i<_.length;i+=1)_[i].c();this.h()},l(i){e=O(i,"MAIN",{});var g=I(e);t=O(g,"BUTTON",{class:!0,"data-svelte-h":!0}),te(t)!=="svelte-h7k3p2"&&(t.textContent=u),m=L(g),c=F(g,"svg",{});var n=I(c);for(let v=0;v<l.length;v+=1)l[v].l(n);n.forEach(D),f=L(g);for(let v=0;v<_.length;v+=1)_[v].l(g);g.forEach(D),this.h()},h(){b(t,"class","svelte-17b77oi")},m(i,g){X(i,e,g),S(e,t),S(e,m),S(e,c);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(c,null);S(e,f);for(let n=0;n<_.length;n+=1)_[n]&&_[n].m(e,null);s||(r=le(t,"click",o[2]),s=!0)},p(i,[g]){if(g&2){d=T(i[1]);let n;for(n=0;n<d.length;n+=1){const v=H(i,d,n);l[n]?l[n].p(v,g):(l[n]=V(v),l[n].c(),l[n].m(c,null))}for(;n<l.length;n+=1)l[n].d(1);l.length=d.length}if(g&1){x=T(i[0]);let n;for(n=0;n<x.length;n+=1){const v=R(i,x,n);_[n]?_[n].p(v,g):(_[n]=U(v),_[n].c(),_[n].m(e,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=x.length}},i:A,o:A,d(i){i&&D(e),N(l,i),N(_,i),s=!1,r()}}}let C=20;function re(o,e,t){let u=0,m=0,c=[],f=[],s={current:null},r=null,d=null;const l=()=>{u=window.innerWidth/2,m=window.innerHeight/2,x()},x=()=>{t(0,c=[]),t(1,f=[]);let a=[5,6,7,6,5,4,3],h=-((a.length-1)/2)*C*Math.sqrt(3);for(let p=0;p<a.length;p++){let w=-((a[p]-1)/2)*C*2;for(let y=0;y<a[p];y++){let E=u+w+y*C*2,M=m+h,P=[];for(let Y=0;Y<6;Y++){let j=(Y*60-30)*(Math.PI/180);P.push({x:E+C/(Math.sqrt(3)/2)*Math.cos(j),y:M+C/(Math.sqrt(3)/2)*Math.sin(j),direction:Y+1})}c.push({x:E,y:M,number:null,blueDots:P})}h+=C*Math.sqrt(3)}},_=(a,h)=>{let p=1/0,w=-1;return c.forEach((y,E)=>{let M=Math.hypot(y.x-a,y.y-h);M<p&&(p=M,w=E)}),p<C?w:null},i=(a,h,p)=>{let w=1/0,y=null;return p.blueDots.forEach(E=>{let M=Math.hypot(E.x-a,E.y-h);M<w&&(w=M,y=E)}),w<C/2?y:null},g=()=>{t(1,f=c.filter(a=>a.number!==null).map(a=>{const h=a.blueDots.find(p=>p.direction===a.number);return h?{x1:a.x,y1:a.y,x2:h.x,y2:h.y}:null}).filter(a=>a!==null))},n=a=>{let h=a.touches[0],p=_(h.clientX,h.clientY);p!==null&&(s.current=p,r=h.clientX,d=h.clientY)},v=a=>{a.preventDefault();let h=a.touches[0],p=_(h.clientX,h.clientY);if(p!==null&&p!==s.current&&(s.current=p),s.current!==null){let w=c[s.current],y=i(h.clientX,h.clientY,w);y&&(t(0,c[s.current]={...c[s.current],number:y.direction},c),t(0,c=[...c]),g())}},G=a=>{let h=a.changedTouches[0];s.current!==null&&Math.hypot(h.clientX-r,h.clientY-d)<5&&(t(0,c[s.current].number=null,c),t(0,c=[...c]),g()),s.current=null},K=async()=>{const a=c.map((h,p)=>h.number!==null?{index:p,number:h.number}:null).filter(h=>h!==null);try{const p=await(await fetch("/send_dots",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dots:a})})).json();console.log("Server response:",p)}catch(h){console.error("Error sending data:",h)}};return Z(()=>{l(),window.addEventListener("resize",l),window.addEventListener("touchstart",n,{passive:!1}),window.addEventListener("touchmove",v,{passive:!1}),window.addEventListener("touchend",G)}),[c,f,K]}class he extends ${constructor(e){super(),ee(this,e,re,ce,Q,{})}}export{he as component};
