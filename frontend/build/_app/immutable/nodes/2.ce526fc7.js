import{s as Q,n as z,o as Z}from"../chunks/scheduler.e108d1fd.js";import{S as $,i as ee,g as Y,y as F,s as B,h as q,j as L,z as G,f as w,c as O,A as te,k as y,a as I,x as T,B as ne,C as N,m as le,n as se,l as C,o as oe}from"../chunks/index.d5bc05ac.js";function S(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}function A(r,e,t){const c=r.slice();return c[16]=e[t],c[18]=t,c}function H(r,e,t){const c=r.slice();return c[19]=e[t],c}function V(r,e,t){const c=r.slice();return c[22]=e[t],c}function J(r){let e,t,c,m,s;return{c(){e=F("line"),this.h()},l(o){e=G(o,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0,"stroke-width":!0}),L(e).forEach(w),this.h()},h(){y(e,"x1",t=r[22].x1),y(e,"y1",c=r[22].y1),y(e,"x2",m=r[22].x2),y(e,"y2",s=r[22].y2),y(e,"stroke","black"),y(e,"stroke-width","2")},m(o,n){I(o,e,n)},p(o,n){n&2&&t!==(t=o[22].x1)&&y(e,"x1",t),n&2&&c!==(c=o[22].y1)&&y(e,"y1",c),n&2&&m!==(m=o[22].x2)&&y(e,"x2",m),n&2&&s!==(s=o[22].y2)&&y(e,"y2",s)},d(o){o&&w(e)}}}function U(r){let e;return{c(){e=Y("div"),this.h()},l(t){e=q(t,"DIV",{class:!0,style:!0}),L(e).forEach(w),this.h()},h(){y(e,"class","blue-dot svelte-14k7rhk"),C(e,"left",r[19].x+"px"),C(e,"top",r[19].y+"px")},m(t,c){I(t,e,c)},p(t,c){c&1&&C(e,"left",t[19].x+"px"),c&1&&C(e,"top",t[19].y+"px")},d(t){t&&w(e)}}}function W(r){let e,t,c=(r[16].number!==null?r[16].number:"")+"",m,s=S(r[16].blueDots),o=[];for(let n=0;n<s.length;n+=1)o[n]=U(H(r,s,n));return{c(){for(let n=0;n<o.length;n+=1)o[n].c();e=B(),t=Y("div"),m=le(c),this.h()},l(n){for(let u=0;u<o.length;u+=1)o[u].l(n);e=O(n),t=q(n,"DIV",{class:!0,style:!0});var _=L(t);m=se(_,c),_.forEach(w),this.h()},h(){y(t,"class","dot svelte-14k7rhk"),C(t,"left",r[16].x+"px"),C(t,"top",r[16].y+"px")},m(n,_){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(n,_);I(n,e,_),I(n,t,_),T(t,m)},p(n,_){if(_&1){s=S(n[16].blueDots);let u;for(u=0;u<s.length;u+=1){const f=H(n,s,u);o[u]?o[u].p(f,_):(o[u]=U(f),o[u].c(),o[u].m(e.parentNode,e))}for(;u<o.length;u+=1)o[u].d(1);o.length=s.length}_&1&&c!==(c=(n[16].number!==null?n[16].number:"")+"")&&oe(m,c),_&1&&C(t,"left",n[16].x+"px"),_&1&&C(t,"top",n[16].y+"px")},d(n){n&&(w(e),w(t)),N(o,n)}}}function re(r){let e,t,c,m,s,o="Send Data",n,_,u=S(r[1]),f=[];for(let i=0;i<u.length;i+=1)f[i]=J(V(r,u,i));let k=S(r[0]),p=[];for(let i=0;i<k.length;i+=1)p[i]=W(A(r,k,i));return{c(){e=Y("main"),t=F("svg");for(let i=0;i<f.length;i+=1)f[i].c();c=B();for(let i=0;i<p.length;i+=1)p[i].c();m=B(),s=Y("button"),s.textContent=o,this.h()},l(i){e=q(i,"MAIN",{});var g=L(e);t=G(g,"svg",{class:!0});var l=L(t);for(let v=0;v<f.length;v+=1)f[v].l(l);l.forEach(w),c=O(g);for(let v=0;v<p.length;v+=1)p[v].l(g);m=O(g),s=q(g,"BUTTON",{class:!0,"data-svelte-h":!0}),te(s)!=="svelte-h7k3p2"&&(s.textContent=o),g.forEach(w),this.h()},h(){y(t,"class","svelte-14k7rhk"),y(s,"class","svelte-14k7rhk")},m(i,g){I(i,e,g),T(e,t);for(let l=0;l<f.length;l+=1)f[l]&&f[l].m(t,null);T(e,c);for(let l=0;l<p.length;l+=1)p[l]&&p[l].m(e,null);T(e,m),T(e,s),n||(_=ne(s,"click",r[2]),n=!0)},p(i,[g]){if(g&2){u=S(i[1]);let l;for(l=0;l<u.length;l+=1){const v=V(i,u,l);f[l]?f[l].p(v,g):(f[l]=J(v),f[l].c(),f[l].m(t,null))}for(;l<f.length;l+=1)f[l].d(1);f.length=u.length}if(g&1){k=S(i[0]);let l;for(l=0;l<k.length;l+=1){const v=A(i,k,l);p[l]?p[l].p(v,g):(p[l]=W(v),p[l].c(),p[l].m(e,m))}for(;l<p.length;l+=1)p[l].d(1);p.length=k.length}},i:z,o:z,d(i){i&&w(e),N(f,i),N(p,i),n=!1,_()}}}let M=20;function ce(r,e,t){let c=0,m=0,s=[],o=[],n={current:null},_=null,u=null;const f=()=>{c=window.innerWidth/2,m=window.innerHeight/2,k()},k=()=>{t(0,s=[]),t(1,o=[]);let a=[5,6,7,6,5,4,3],h=-((a.length-1)/2)*M*Math.sqrt(3);for(let d=0;d<a.length;d++){let x=-((a[d]-1)/2)*M*2;for(let b=0;b<a[d];b++){let D=c+x+b*M*2,E=m+h,R=[];for(let X=0;X<6;X++){let j=(X*60-30)*(Math.PI/180);R.push({x:D+M/(Math.sqrt(3)/2)*Math.cos(j),y:E+M/(Math.sqrt(3)/2)*Math.sin(j),direction:X+1})}s.push({x:D,y:E,number:null,blueDots:R})}h+=M*Math.sqrt(3)}},p=(a,h)=>{let d=1/0,x=-1;return s.forEach((b,D)=>{let E=Math.hypot(b.x-a,b.y-h);E<d&&(d=E,x=D)}),d<M?x:null},i=(a,h,d)=>{let x=1/0,b=0;return d.blueDots.forEach(D=>{let E=Math.hypot(D.x-a,D.y-h);E<x&&(x=E,b=D)}),x<M/2?b:null},g=()=>{t(1,o=s.filter(a=>a.number!==0).map(a=>{const h=a.blueDots.find(d=>d.direction===a.number);return h?{x1:a.x,y1:a.y,x2:h.x,y2:h.y}:null}).filter(a=>a!==null))},l=a=>{let h=a.touches[0],d=p(h.clientX,h.clientY);d!==null&&(n.current=d,_=h.clientX,u=h.clientY)},v=a=>{a.preventDefault();let h=a.touches[0],d=p(h.clientX,h.clientY);if(d!==null&&d!==n.current&&(n.current=d),n.current!==null){let x=s[n.current],b=i(h.clientX,h.clientY,x);b&&(t(0,s[n.current]={...s[n.current],number:b.direction},s),t(0,s=[...s]),g())}},P=a=>{let h=a.changedTouches[0];n.current!==null&&Math.hypot(h.clientX-_,h.clientY-u)<5&&(t(0,s[n.current].number=null,s),t(0,s=[...s]),g()),n.current=null},K=async()=>{const a={dots:s.map((h,d)=>h.number!==null?{index:d,number:h.number}:null).filter(h=>h!==null)};try{const d=await(await fetch("/send_dots",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();console.log("Server Response:",d)}catch(h){console.error("Error sending dots:",h)}};return Z(()=>(f(),window.addEventListener("resize",f),window.addEventListener("touchstart",l,{passive:!1}),window.addEventListener("touchmove",v,{passive:!1}),window.addEventListener("touchend",P),()=>{window.removeEventListener("resize",f),window.removeEventListener("touchstart",l),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",P)})),[s,o,K]}class he extends ${constructor(e){super(),ee(this,e,ce,re,Q,{})}}export{he as component};
