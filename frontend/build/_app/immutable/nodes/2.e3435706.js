import{s as q,n as v,o as I}from"../chunks/scheduler.e108d1fd.js";import{S as O,i as k,g as _,h as D,j as B,y as L,f as M,k as P,a as j,x as N,z as R}from"../chunks/index.c1d64499.js";function z(y){let o,a,l="Send Data",s,p;return{c(){o=_("main"),a=_("button"),a.textContent=l,this.h()},l(c){o=D(c,"MAIN",{});var f=B(o);a=D(f,"BUTTON",{class:!0,"data-svelte-h":!0}),L(a)!=="svelte-h7k3p2"&&(a.textContent=l),f.forEach(M),this.h()},h(){P(a,"class","svelte-17b77oi")},m(c,f){j(c,o,f),N(o,a),s||(p=R(a,"click",y[0]),s=!0)},p:v,i:v,o:v,d(c){c&&M(o),s=!1,p()}}}let d=20;function H(y){let o=0,a=0,l=[],s={current:null},p=null,c=null;const f=()=>{o=window.innerWidth/2,a=window.innerHeight/2,C()},C=()=>{l=[];let e=[5,6,7,6,5,4,3],t=-((e.length-1)/2)*d*Math.sqrt(3);for(let n=0;n<e.length;n++){let i=-((e[n]-1)/2)*d*2;for(let r=0;r<e[n];r++){let u=o+i+r*d*2,h=a+t,g=[];for(let m=0;m<6;m++){let w=(m*60-30)*(Math.PI/180);g.push({x:u+d/(Math.sqrt(3)/2)*Math.cos(w),y:h+d/(Math.sqrt(3)/2)*Math.sin(w),direction:m+1})}l.push({x:u,y:h,number:null,blueDots:g})}t+=d*Math.sqrt(3)}},x=(e,t)=>{let n=1/0,i=-1;return l.forEach((r,u)=>{let h=Math.hypot(r.x-e,r.y-t);h<n&&(n=h,i=u)}),n<d?i:null},S=(e,t,n)=>{let i=1/0,r=null;return n.blueDots.forEach(u=>{let h=Math.hypot(u.x-e,u.y-t);h<i&&(i=h,r=u)}),i<d/2?r:null},b=()=>{l.filter(e=>e.number!==null).map(e=>{const t=e.blueDots.find(n=>n.direction===e.number);return t?{x1:e.x,y1:e.y,x2:t.x,y2:t.y}:null}).filter(e=>e!==null)},T=e=>{let t=e.touches[0],n=x(t.clientX,t.clientY);n!==null&&(s.current=n,p=t.clientX,c=t.clientY)},E=e=>{e.preventDefault();let t=e.touches[0],n=x(t.clientX,t.clientY);if(n!==null&&n!==s.current&&(s.current=n),s.current!==null){let i=l[s.current],r=S(t.clientX,t.clientY,i);r&&(l[s.current]={...l[s.current],number:r.direction},l=[...l],b())}},X=e=>{let t=e.changedTouches[0];s.current!==null&&Math.hypot(t.clientX-p,t.clientY-c)<5&&(l[s.current].number=null,l=[...l],b()),s.current=null},Y=async()=>{const e=l.map((t,n)=>t.number!==null?{index:n,number:t.number}:null).filter(t=>t!==null);try{const n=await(await fetch("/send_dots",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dots:e})})).json();console.log("Server response:",n)}catch(t){console.error("Error sending data:",t)}};return I(()=>{f(),window.addEventListener("resize",f),window.addEventListener("touchstart",T,{passive:!1}),window.addEventListener("touchmove",E,{passive:!1}),window.addEventListener("touchend",X)}),[Y]}class J extends O{constructor(o){super(),k(this,o,H,z,q,{})}}export{J as component};
